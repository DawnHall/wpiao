<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Dashboard Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="./vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet"> -->

    <!-- Custom styles for this template -->
    <link href="dashboard.css" rel="stylesheet">

    <style type="text/css">
      [v-cloak] {
        display: none;
      }
    </style>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="#">Overview <span class="sr-only">(current)</span></a></li>
            <li><a href="#">Reports</a></li>
            <li><a href="#">Analytics</a></li>
            <li><a href="#">Export</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Nav item</a></li>
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
            <li><a href="">More navigation</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
          </ul>
        </div>

        <div id="wrapper" v-cloak>
          <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <div v-if="step=='parseurl'" class="input-group">
              <span class="input-group-addon">xx地址：</span>
              <input type="text" class="form-control" v-model="url">
            </div>

            <div v-if="step=='voteresult'">
              <div class="row">
                <div class="col-sm-4">
                  <div class="input-group">
                    <span class="input-group-addon">xx名称</span>
                    <input type="text" class="form-control" placeholder="xx名称" v-model="voteinfo.title" readonly>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="input-group">
                    <span class="input-group-addon">截止时间</span>
                    <input type="text" class="form-control" placeholder="Username" v-model="expireTime" readonly>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="input-group">
                    <span class="input-group-addon">xx人数</span>
                    <input type="text" class="form-control" placeholder="Username" v-model="voteinfo.total_person" readonly>
                  </div>
                </div>
              </div>
              <br>

              <mysubject v-for="subject in voteinfo.vote_subject" :model="subject"></mysubject>
            </div>

            <div v-if="step=='submittask'">
              <div>
                <div class="input-group">
                  <span class="input-group-addon">任务名称：</span>
                  <input type="text" class="form-control" v-model="voteinfo.title" readonly>
                </div>
                <br>
                <div class="input-group">
                  <span class="input-group-addon">任务单价：</span>
                  <input type="text" class="form-control" v-model="task.price" readonly>
                  <span class="input-group-addon">元</span>
                </div>
                <br>
                <div class="input-group">
                  <span class="input-group-addon">截止时间：</span>
                  <input type="text" class="form-control" v-model="expireTime" readonly>
                </div>
                <br>
                <div class="input-group">
                  <span class="input-group-addon">投票总数：</span>
                  <input type="text" class="form-control" v-model="task.votes">
                </div>
                <br>
                <div class="input-group">
                  <span class="input-group-addon">投票速度：</span>
                  <input type="text" class="form-control" v-model="task.votespermin">
                  <span class="input-group-addon">票/分钟</span>
                </div>
              </div>
            </div>

            <br>
            <div class="col-sm-offset-11">
              <input type="button" class="form-control" @click="next" value="下一步">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./vendor/vuejs/vue.js"></script>
    <script src="./vendor/jquery/jquery.min.js"></script>
    <script src="./vendor/bootstrap/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <!-- <script src="../../assets/js/vendor/holder.min.js"></script> -->
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->

    <script type="text/x-template" id="mysubject-template">
      <div>
        <div class="panel panel-default">
          <div class="panel-heading">{{model.title}}</div>
          <table class="table table-striped">
            <thead>
              <tr>
                <th>选择</th>
                <th>序号</th>
                <th>选手名称</th>
                <th>票数</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(option, index) in model.options">
                <td>
                  <input type="radio" v-bind:name="model.vote_id" v-bind:value="index" v-model="model.item_idx" v-if="model.type==1">
                  <input type="checkbox" v-bind:name="model.vote_id" v-model="option.selected" v-if="model.type==2">
                </td>
                <td>{{index}}</td>
                <td>{{option.name}}</td>
                <td>{{option.cnt}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </script>

    <script type="text/javascript">
      // var voteInfo = {
      //   title: "站前小学“书香家庭”评选活动",
      //   vote_permission: 1,
      //   expire_time: 1486900800,
      //   total_person: 34451,
      //   vote_subject: [
      //     {
      //       type: 1,
      //       title: "参加站前小学“书香家庭”评选活动的家庭",
      //       options: [
      //         {
      //           name: "一（1）班魏佳宝家庭",
      //           url: "http://mmbiz.qpic.cn/mmbiz_jpg/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYRA9uNvaUhJHX5BwLJutC2vbTtOIprXAMLHyyq5yEc5GtPBtc207hww/0?wx_fmt=jpeg",
      //           cnt: 1407,
      //           selected: false
      //         },
      //         {
      //           name: "一（2）班吴佳骏家庭",
      //           url: "http://mmbiz.qpic.cn/mmbiz_jpg/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY3alszWGDDYFElkBTqKp2dWq71Vu55P3fFdJ74KXtAgiaqfNu6RVIbQw/0?wx_fmt=jpeg",
      //           cnt: 434,
      //           selected: false
      //         }
      //       ],
      //       total_cnt: 34451,
      //       vote_id: 684888407
      //     }
      //   ],
      //   super_vote_id: 684888406,
      //   del_flag: 0
      // };

      // var voteInfo = {"title":"德孝模范评选微信投票","vote_permission":1,"expire_time":1481342400,"total_person":15981,"vote_subject":[{"type":2,"title":"家庭和睦模范投票（最多选3人）","options":[{"name":"家庭和睦模范候选人---赵鲜霞","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3IC4zcTlBeWWI4P69JBf2OtadPZOMBRRoWXfUh19QyFHj9FnHWicVzNA\/0?wx_fmt=jpeg","cnt":3884,"selected":false},{"name":"家庭和睦模范候选人---杨红霞","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3Kp2un8gwxnLN0A6PzMTk1npw4DZGp89fqVAXEOUibZmXl2OeicIPhI7A\/0?wx_fmt=jpeg","cnt":2628,"selected":false},{"name":"家庭和睦模范候选人---张家龙","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia32DgPqfK5ArTpY0iboYkG4JtajOdVR4C8157rJeJ4c5BEvWiatFG7bnnQ\/0?wx_fmt=jpeg","cnt":3049,"selected":false},{"name":"家庭和睦模范候选人---成小宽","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3s3fkmk8OYSHWB84hicD9NJ7j8UmU6AUjMicHfDBXtM4brlrUVicLooib1A\/0?wx_fmt=jpeg","cnt":3489,"selected":false},{"name":"家庭和睦模范候选人---成红兵","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia34WsyRobSFwgF2ibuzDeTGnqK3WawZoyzgNSDhqlYfbjthfKg7WCxChg\/0?wx_fmt=jpeg","cnt":5127,"selected":false}],"total_cnt":18177,"vote_id":481832253},{"type":2,"title":"孝老爱亲模范投票（最多选3人）","options":[{"name":"孝老爱亲模范候选人---马新会","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3KTOqXyfTocnLH6hxAJbWiaJRoCibcDw2ibsSRLCUleMR770kFUcnGL4fw\/0?wx_fmt=jpeg","cnt":1524,"selected":false},{"name":"孝老爱亲模范候选人---成锁红","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia39oWF9pBdUTqlIGIrzkWbcXnl8VjTicVwPnkMS3lUUqsfT8DTfTmB3ng\/0?wx_fmt=jpeg","cnt":4017,"selected":false},{"name":"孝老爱亲模范候选人---成海霞","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3qv73dSJCx6bz8aib0kvqsYTXNXfIaKQGc6m2j1y7r3aY1ZNmH7LyAwQ\/0?wx_fmt=jpeg","cnt":1533,"selected":false},{"name":"孝老爱亲模范候选人---成冲林","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3AqdzMvDkrGoiaJArUNddP2JY3qNZoicKXoI27pibgsXdLcODZWUNDXEtg\/0?wx_fmt=jpeg","cnt":5591,"selected":false},{"name":"孝老爱亲模范候选人---白兴龙","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3VqLbKZQyNiawFHpfLv4aTFicW1B0lSCsK91LRjcVVqTktMJyNKFLHZfA\/0?wx_fmt=jpeg","cnt":769,"selected":false},{"name":"孝老爱亲模范候选人---成红霞","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3uwgibYlQog0suCibJ48cV9jKloibk99rfG6lJGEyXyQDBGbdS2I3VciccQ\/0?wx_fmt=jpeg","cnt":955,"selected":false},{"name":"孝老爱亲模范候选人---马宽锋","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia382XGN3s90zgMQxxCzNlVaqYBrhAF54Tu96ArTia7MEzLI3jZvItDVuA\/0?wx_fmt=jpeg","cnt":4426,"selected":false}],"total_cnt":18815,"vote_id":481832254},{"type":2,"title":"助人为乐模范投票（最多选3人）","options":[{"name":"助人为乐模范候选人---赵芳研","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3eLuDklwXiaX4yqDU6vNf2yrJA8rI41vSOghYtlYSQJkeTeDRCumJuLg\/0?wx_fmt=jpeg","cnt":4719,"selected":false},{"name":"助人为乐模范候选人---张连会","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3uxbXfbddKF27RvBbibRp2wC2umxLohB4tOCJdtq930zSiaMINyVMpd1w\/0?wx_fmt=jpeg","cnt":3147,"selected":false},{"name":"助人为乐模范候选人---马进龙","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia36YjhCSm22ZXG5CR9et6lCa4Ko7iaIW7a16TOEhkcQm2TGKDFENBaReg\/0?wx_fmt=jpeg","cnt":4119,"selected":false},{"name":"助人为乐模范候选人---李千万","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/Tibp1QKkyT4K7Lz2VJSOjN4lmnYnrozia3jNnZcNyCWUTALlPCfweHZXzcIgFfTU00SDaSBRJotIuMkYZIO1EPeA\/0?wx_fmt=jpeg","cnt":4050,"selected":false},{"name":"助人为乐模范候选人---张永战","cnt":2173,"selected":false}],"total_cnt":18208,"vote_id":481832255}],"super_vote_id":481832252,"del_flag":0};
      // var voteInfo = {"title":"站前小学“书香家庭”评选活动","vote_permission":1,"expire_time":1486900800,"total_person":34451,"vote_subject":[{"type":1,"title":"参加站前小学“书香家庭”评选活动的家庭","options":[{"name":"一（1）班魏佳宝家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYRA9uNvaUhJHX5BwLJutC2vbTtOIprXAMLHyyq5yEc5GtPBtc207hww\/0?wx_fmt=jpeg","cnt":1407,"selected":false},{"name":"一（2）班吴佳骏家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY3alszWGDDYFElkBTqKp2dWq71Vu55P3fFdJ74KXtAgiaqfNu6RVIbQw\/0?wx_fmt=jpeg","cnt":434,"selected":false},{"name":"一（3）班张自焜家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYpnUqSbgQJRb0u0iaZ4yicNH0jN0TJtnB29ZY3kCMONeS83h2vw5X2MAA\/0?wx_fmt=jpeg","cnt":1459,"selected":false},{"name":"一（4）班谢博宇家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYkCTicPXSQJvzxIkbXxlrRQsSFcT11ia6ZCuPV3Bj3I7Rdf7sOY15H12Q\/0?wx_fmt=jpeg","cnt":2701,"selected":false},{"name":"二（1）班张思华家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYyDibhqdgMba72YHHJx0OAVHqZ2ZrrzGkjzQF5XNwQIAblDzE5EacoKg\/0?wx_fmt=jpeg","cnt":426,"selected":false},{"name":"二（2）班董书彤家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY3M61xhhlC0pAaEibnSSBKyRC3icibvx4qjEbUiaWC2PXFeNjZFLkSdAMBQ\/0?wx_fmt=jpeg","cnt":558,"selected":false},{"name":"二（3）班高天然家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY2COBxW67jQSu3BWOxVjczUMt8iaCsjOPdP2tlNicFibSwgWNoOajqeTMg\/0?wx_fmt=jpeg","cnt":730,"selected":false},{"name":"二（4）班张靖雯家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYHwNUrnnHUlxDA8XcUkaiaGpricIEJQInmwvgDZrr6k5wp3PwmDx0fm9A\/0?wx_fmt=jpeg","cnt":3450,"selected":false},{"name":"三（1）班王紫郡家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYj9JibZZSKC1U97kmUJkat8olpynbficKRkwhvLbIWxv52ZFia5ndibmOxQ\/0?wx_fmt=jpeg","cnt":355,"selected":false},{"name":"三（2）班孙震家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYDhFerq0cNndu5Bficl7yzicdcluN8ElmT9dlnvUtukUfF8EibLwGSqntQ\/0?wx_fmt=jpeg","cnt":899,"selected":false},{"name":"三（3）班杨昊喆家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY3Nkjl0XkQ2ibK6NuJtXIL5CaV6ciasaCgOdfte6jwQbxn0T5lft3NOsw\/0?wx_fmt=jpeg","cnt":2751,"selected":false},{"name":"三（4）班王珺锴家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYoTIlVpKsXgvoVHrXiaQkgMhwUicXujxuzswTI5scZ6H6HeHjKpEf8iapA\/0?wx_fmt=jpeg","cnt":525,"selected":false},{"name":"四（1）班李恺辛家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY4iaGccx1NfUpiavpXDzgqajy8Nbslyk6EKZGt0y4WUia6jVkfgyXSaUwg\/0?wx_fmt=jpeg","cnt":1918,"selected":false},{"name":"四（2）班任佳怡家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYET98jSnICkj7Yaic2rib2OkZWSzpHiaiaNu5BtnSqhRXZaiaicZOgplib6Ynw\/0?wx_fmt=jpeg","cnt":1567,"selected":false},{"name":"四（3）班张添义家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYQXwzGLmHd39kklkn6DOwbcs1cPefiaFianyTb2dgzblzk4lUJ1xAvVnA\/0?wx_fmt=jpeg","cnt":4339,"selected":false},{"name":"四（4）班代舒宇家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txY3MM9MBRs2p099jZSd6FEZcP5OEDTlshZGUkY2iafc68k4RdUkEQSlBg\/0?wx_fmt=jpeg","cnt":353,"selected":false},{"name":"五（1）班鄂晓萌家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYs8FKfkuIlFbTL22X7u9ldiclHkHyQdficbs60wKictHC8lSLZmsAic00pw\/0?wx_fmt=jpeg","cnt":3747,"selected":false},{"name":"五（2）班吴昊家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYS4wwCJVcib6HUu440HWw7lbfzdzqOWUz6eXxgh7BFiaMh9cPUn9NuHibA\/0?wx_fmt=jpeg","cnt":916,"selected":false},{"name":"五（3）班金爽家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYibfITQzNobaVrHHeVceaReWdrpruqNIedQM70CfQvLyqz2zejmNf3Qw\/0?wx_fmt=jpeg","cnt":356,"selected":false},{"name":"五（4）班盛曦瑶家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYwsiabP6JG0eOWosIGdiapYfiaRznDYK42WsNia548XHCY8RI2MlI9kibGDQ\/0?wx_fmt=jpeg","cnt":2238,"selected":false},{"name":"六（1）班宋歌、宋朝家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYDMWYfBGcQiazHP0OQ4nOLu4dWeVYQMbVJM0n9tx5dNibrJZazhpfMuEQ\/0?wx_fmt=jpeg","cnt":1057,"selected":false},{"name":"六（2）班王嘉欣家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYDkQxIkv5pKKPXVicnYgQia3mb5wdDJCqedjBZNJiblIlS8gmDxZlnxOLg\/0?wx_fmt=jpeg","cnt":725,"selected":false},{"name":"六（3）班高逸可家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYN3eC4y6xIWNTLicaKs0UGfagicW8HjqKR9IdYKj46lokelELcpmEDoPA\/0?wx_fmt=jpeg","cnt":650,"selected":false},{"name":"六（4）班付航家庭","url":"http:\/\/mmbiz.qpic.cn\/mmbiz_jpg\/356Z1iboRaSyU9t6fAr2eKInSib4DA6txYIyEeeGKHwDqVBAhzp4dAM9xxepVj1X5wTqHJ1k16NdicgG8N7NrNWUQ\/0?wx_fmt=jpeg","cnt":890,"selected":false}],"total_cnt":34451,"vote_id":684888407}],"super_vote_id":684888406,"del_flag":0};
      var voteInfo = null;
      $(function() {
        Vue.component('mysubject', {
          template: '#mysubject-template',
          props: {
              model: Object
          },
          // data: function () {
          //     // return {open: false}
          //     return {}
          // },
          computed: {
              // isFolder: function() {},
          },
          methods: {
              // toggleFolder: function() {}
          }
        });

        Date.prototype.Format = function (fmt) { //author: meizz 
            var o = {
                "M+": this.getMonth() + 1, //月份 
                "d+": this.getDate(), //日 
                "h+": this.getHours(), //小时 
                "m+": this.getMinutes(), //分 
                "s+": this.getSeconds(), //秒 
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度 
                "S": this.getMilliseconds() //毫秒 
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        };

        // window.data = {voteinfo: voteInfo};
        vm = new Vue({
          el: '#wrapper',
          data: {
            voteinfo: voteInfo, // null
            url: 'http://mp.weixin.qq.com/s/WEBkpBjBdOAIXxu9fknV9w', // 方便调试
            step: 'parseurl',
            task: {},
          },
          computed: {
            expireTime: function() {
              var d = new Date();
              d.setTime(this.voteinfo.expire_time*1000);
              return d.Format('yyyy-MM-dd hh:mm:ss');
            }
          },
          watch: {
            // selected: function() {},
          },
          methods: {
            next: function() {
              console.log('step: ' + this.step);
              this[this.step]();
              // if (this.step == 'parseurl') {
              //   this.parseurl();
                
              // }
              // else if (this.step == 'voteresult') {
              //   this.voteresult();
              //   this.step = 'submittask';
              // }
              // else if (this.step == 'submittask') {
              //   this.submittask();
              //   // this.step = '';
              // }
            },
            parseurl: function() {
              console.log('parseurl:' + this.url);
              var url = '/api/parseurl?url='+this.url;
              var vm = this;
              // var url = 'voteInfo2.json';
              $.getJSON(url, function(data, status) {
                console.log('voteinfo='+JSON.stringify(data));
                vm.$set(vm,'voteinfo', data);
                vm.step = 'voteresult';
                // Vue.set(vm.data, 'voteinfo', 2)
              });
            },
            voteresult: function() {
              console.log('voteresult:'/*+JSON.stringify(this.voteinfo)*/);
              // {"super_vote_item":[{"vote_id":684888407,"item_idx_list":{"item_idx":["0"]}}],"super_vote_id":684888406}
              var super_vote_item = [];
              for (var i = 0; i < this.voteinfo.vote_subject.length; i++) {
                var vote_subject = this.voteinfo.vote_subject[i];

                var item_idx = [];
                if (vote_subject.type == 1) { // 单选
                  item_idx.push(''+vote_subject.item_idx);
                } else if (vote_subject.type == 2) {
                  item_idx = vote_subject.item_idx;
                }
                console.log('item_idx: ' + item_idx);

                super_vote_item.push({vote_id: vote_subject.vote_id, item_idx_list: {item_idx: item_idx}});
              }
              var voteResult = {
                super_vote_id: this.voteinfo.super_vote_id,
                super_vote_item: super_vote_item
              };
              var voteResultStr = JSON.stringify(voteResult);
              console.log('voteResult: ' + voteResultStr);

              var vm = this;
              var url = '/api/submittask?task='+voteResultStr;
              console.log('url: ' + url);
              $.getJSON(url, function(data, status) {
                console.log('/api/submittask:');
                // console.log('/api/submittask: data=' + JSON.stringify(data) + ',status=' + status);
                vm.$set(vm, 'task', {
                  price: 0.07,
                  votes: 200,
                  votespermin: 50,
                });
                vm.step = 'submittask';
              });
            },
            submittask: function() {
              console.log('submittask:');
              // TODO
              this.step = '';
            }
          }
        });
      });
    </script>
  </body>
</html>
